<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>APARS - Car</title>
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="js/menu.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <script>
        window.onload = function() {
            const replaceTimestamp = localStorage.getItem('replaceTimestamp') === 'true'; // Get the toggle state from local storage
            document.getElementById('toggle-status').textContent = replaceTimestamp ? "Enabled" : "Disabled";

            if (replaceTimestamp) {
                updateIframesWithTimestamp();
            }
        }

        function updateIframesWithTimestamp() {
            const iframes = document.querySelectorAll('iframe');
            const currentTimestamp = Date.now();

            iframes.forEach(iframe => {
                let src = iframe.getAttribute('src');
                if (src.includes('from=') && src.includes('to=')) {
                    src = src.replace(/from=\d+/, `from=${currentTimestamp - 60000}`); // 1 minute before current time
                    src = src.replace(/to=\d+/, `to=${currentTimestamp}`);
                    iframe.setAttribute('src', src);
                }
            });
        }

        function toggleTimestampReplacement() {
            const currentStatus = localStorage.getItem('replaceTimestamp') === 'true';
            const newStatus = !currentStatus;
            localStorage.setItem('replaceTimestamp', newStatus); // Store the new status in local storage
            location.reload(); // Reload the page to apply the change
        }
    </script>
</head>

<body>

    <div class="navbar">
        <!-- Menu Icon and APARS Logo -->
        <div class="menu-logo">
            <span class="menu-icon" onclick="openMenu()">☰</span>
            <div class="logo">APARS</div>
        </div>
        
        <!-- Current Date and Time -->
        <div id="datetime" class="date-user"></div>
    </div>
    
    <!-- Side Menu -->
    <div id="side-menu" class="side-menu">
        <a href="javascript:void(0)" class="close-btn" onclick="closeMenu()">×</a>
        <a href="index.html">Home</a>
        <a href="#">Cars</a>
        <a href="station.html">Stations</a>
        <a href="about.html">About</a>
    </div>

    <iframe 
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=1&__feature.dashboardSceneSolo" 
        width="79.3%" height="600px" style="margin-top: 10px; margin-left: 10%; margin-right: 10%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=8&__feature.dashboardSceneSolo"
        width="39%" height="244" style="margin-left: 10%; margin-right: 0%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=9&__feature.dashboardSceneSolo"
        width="40%" height="244" style="margin-left: 0%; margin-right: 10%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=4&__feature.dashboardSceneSolo"
        width="26%" height="244" style="margin-left: 10%; margin-right: 0%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=5&__feature.dashboardSceneSolo"
        width="27%" height="244" style="margin-left: 0%; margin-right: 0%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=6&__feature.dashboardSceneSolo"
        width="26%" height="244" style="margin-left: 0%; margin-right: 10%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=2&__feature.dashboardSceneSolo"
        width="26%" height="244" style="margin-left: 10%; margin-right: 0%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards?from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=11&__feature.dashboardSceneSolo"
        width="27%" height="244" style="margin-left: 0%; margin-right: 0%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=3&__feature.dashboardSceneSolo"
        width="26%" height="244" style="margin-left: 0%; margin-right: 10%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=13&__feature.dashboardSceneSolo"
        width="39%" height="244" style="margin-left: 10%; margin-right: 0%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=12&__feature.dashboardSceneSolo"
        width="40%" height="244" style="margin-left: 0%; margin-right: 10%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=10&__feature.dashboardSceneSolo"
        width="39%" height="244" style="margin-left: 10%; margin-right: 0%; padding: 0%;" frameborder="0"></iframe>
    <iframe
        src="https://labserver.sense-campus.gr:8087/d-solo/cea3pjwio8ikgb/car-dashboards??from=1739005576432&to=1739006128809&timezone=browser&refresh=5m&orgId=2&panelId=7&__feature.dashboardSceneSolo"
        width="40%" height="244" style="margin-left: 0%; margin-right: 10%; padding: 0%;" frameborder="0"></iframe>

    <div style="text-align: center; margin-top: 20px;">
        <button onclick="toggleTimestampReplacement()" style="padding: 10px 20px; font-size: 16px;">Toggle Demo/Real</button>
        <p>View current data is currently: <span id="toggle-status">Enabled</span></p>
    </div>
</body>

</html>